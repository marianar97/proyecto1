 <!DOCTYPE html>
    <html lang="en">
        <head>
             <link rel="stylesheet" href="/css/home.css"/>
        </head>
        
        <body onload="getLocation">
            
            <main role="main" class="inner-cover">
                {{#if user}}
                
                
                    <div id="googleMap" style="width:100%;height:400px;"></div>
                    <p id="demo" name="demo">Tu ubicación se está cargando...</p>
                    
                    <form  id= "myForm" name="sumb" method="post" action="/users/index" id="fm">
                        <input type="text" id="lat" class="form-control"  name="lat" placeholder="Latitude"required autofocus>
                        <input type="text" id="lng" class="form-control"  name="lng" placeholder="Longitud"required autofocus>
                    </form>

                    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCOhIkbOglhBq0Y0Ka08iROiG_xqOKFIsA&callback=getLocation()" async defer></script> 
                    <script type="text/javascript">              
                    

                        var x = document.getElementById("demo");

                        function getLocation() {
                            if (navigator.geolocation) {
                                console.log("llama a currentPosition")
                                navigator.geolocation.getCurrentPosition(showPosition);
                                console.log("LLama a info")
                                navigator.geolocation.getCurrentPosition(info);
                                //refresh();
                            } else {
                                x.innerHTML = "Geolocation is not supported by this browser.";
                            }
                        }


                        function showPosition(position) {
                            x.innerHTML = "ENTRAAAA"
                            console.log("position",position)

                            var positionInfo = "Tu ubicación es: </br>" + "Latitud: " + position.coords.latitude + ", " + "</br> Longitud: " + position.coords.longitude;
                            document.getElementById("demo").innerHTML = positionInfo;

                            var myCenter = new google.maps.LatLng(position.coords.latitude,position.coords.longitude);
                            var mapCanvas = document.getElementById("googleMap");
                            var mapOptions = {center: myCenter, zoom: 15};
                            var map = new google.maps.Map(mapCanvas, mapOptions);
                            var marker = new google.maps.Marker({position:myCenter});
                            marker.setMap(map);
                            
                            
                        }

                        function info(position) {    
                            var a1 = document.getElementById("lat");
                            a1.value = position.coords.latitude; 
                            var a2 = document.getElementById("lng");
                            a2.value = position.coords.longitude; 
                            document.getElementById("myForm").submit();
                            addMacker(parseFloat(position.coords.latitude), position.coords.longitude);
                            //setTimeout("window.open('https://10.131.137.217', '_self');", 5000);
                            
                        }
                            function refresh() {
                                var ciclo = setInterval(getLocation, 1000);
                            }


                    </script>

                {{else}}
                    <h1 class="cover-heading">¿A dónde vas?</h1>
                    <p class="lead">Basado en los lugares en que recorres con tu celular podrás ver los sitios a los que vas en el mapa e incluso tus rutas</br> ¿Qué esperas para registrarte?</p>
                    <a href="/users/register">
                        <img src="/images/mapicon.png" alt="map">        
                    </a>
                {{/if}} 
            </main>
            
        </body>
</html>

