 <!DOCTYPE html>
    <html lang="en">
        <head>
             <link rel="stylesheet" href="/css/home.css"/>
        </head>
        
        <body onload="getLocation();">
            
            <main role="main" class="inner-cover">
                {{#if user}}

                    <div id="googleMap" style="width:100%;height:400px;"></div>
                    <p id="demo" name="demo">Tu ubicación se está cargando...</p>
                    
                    <form  id= "myForm" name="sumb" method="post" action="/users/index" id="fm">
                        <input type="text" id="lat" class="form-control"  name="lat" placeholder="Latitude"required autofocus>
                        <input type="text" id="lng" class="form-control"  name="lng" placeholder="Longitud"required autofocus>
                    </form>

                    <script type="text/javascript">

                        var x = document.getElementById("demo");

                        function getLocation() {
                            if (navigator.geolocation) {
                                console.log("llama a currentPosition")
                                navigator.geolocation.getCurrentPosition(showPosition);
                                navigator.geolocation.getCurrentPosition(info);
                            } else {
                                x.innerHTML = "Geolocation is not supported by this browser.";
                            }
                        }


                        function showPosition(position) {
                            console.log("position",position)

                            var positionInfo = "Tu ubicación es: </br>" + "Latitud: " + position.coords.latitude + ", " + "</br> Longitud: " + position.coords.longitude;
                            document.getElementById("demo").innerHTML = positionInfo;
                            var mapProp = {
                                center: new google.maps.LatLng(position.coords.latitude,position.coords.longitude ),
                                zoom: 15,
                            };
                                var map = new google.maps.Map(document.getElementById("googleMap"), mapProp);
                        }

                        function info(position) {    
                            var a1 = document.getElementById("lat");
                            a1.value = position.coords.latitude; 
                            var a2 = document.getElementById("lng");
                            a2.value = position.coords.longitude; 
                            document.getElementById("myForm").submit();
                            setTimeout("window.open('https://10.131.137.217', '_self');", 10000);
                    }

                    </script>

                   <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCOhIkbOglhBq0Y0Ka08iROiG_xqOKFIsA&callback=showPosition"></script>

                {{else}}
                    <h1 class="cover-heading">¿A dónde vas?</h1>
                    <p class="lead">Basado en los lugares en que recorres con tu celular podrás ver los sitios a los que vas en el mapa e incluso tus rutas</br> ¿Qué esperas para registrarte?</p>
                    <a href="/users/register">
                        <img src="/images/mapicon.png" alt="map">        
                    </a>
                {{/if}} 
            </main>
            
        </body>
</html>
